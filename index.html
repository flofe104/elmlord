<!DOCTYPE HTML>
<html>

<head>
  <meta charset="UTF-8">
  <title>Elmlord</title>
  <script type="text/javascript" src="elm.js"></script>
</head>

<body>
    <div id="myapp"></div>
</body>

<script type="text/javascript">

var app = Elm.Main.init({
    node: document.getElementById('myapp')
});

setVolumne(10);

app.ports.updateVolumne.subscribe(function(volumne) {
    setVolumne(volumne);
});

app.ports.startMusic.subscribe(function() {
    startMusic();
});

app.ports.playSound.subscribe(function(sound) {
    muteAndUnmuteSound("sound-player", "audio-player", "./assets/sounds/SoundEffects/" + sound + ".wav");
});

app.ports.transitSoundToMusic.subscribe((object) => {
    muteAndUnmuteSound("sound-player", "audio-player", "./assets/sounds/SoundEffects/" + object[0] + ".wav");
    
    setTimeout(() => {
        startMusic();
    }, object[1]);
});
 
app.ports.openLink.subscribe((link) => {
    window.open(link, '_blank');
});


function setVolumne(volumne) {
    document.getElementById("audio-player").volume = volumne / 100;
    document.getElementById("sound-player").volume = volumne / 100;
}

function startMusic() {
    document.getElementById("sound-player").pause();
    document.getElementById("audio-player").play();
}

function muteAndUnmuteSound(playerOne, playerTwo, sound) {
    document.getElementById(playerTwo).pause();
    document.getElementById(playerOne).setAttribute("src", sound);
    document.getElementById(playerOne).play();
}

</script>

</html>